[PHP]

;;;;;;;;;;;;
; Security ;
;;;;;;;;;;;;

<% if @paranoid %>
;safe_mode = On
safe_mode_gid = Off
safe_mode_include_dir =
safe_mode_exec_dir =
safe_mode_allowed_env_vars = PHP_
safe_mode_protected_env_vars = LD_LIBRARY_PATH

open_basedir = .

disable_functions = system, exec, shell_exec, passthru, pcntl_exec, popen, proc_open, pclose, proc_close, proc_nice, proc_terminate, proc_get_status, escapeshellcmd, escapeshellarg
disable_functions = posix_kill, posix_mkfifo, posix_setpgid, posix_setsid, posix_setuid
disable_functions = fopen_with_path, dbmopen, dbase_open, putenv, move_uploaded_file, show_source, filepro, filepro_rowcount, filepro_retrieve, apache_child_terminate
;; disable_functions = chdir, mkdir, rmdir, chmod, rename, phpinfo
;; disable_classes = DirectoryIterator, Directory

enable_dl = Off

allow_url_fopen = On
allow_url_include = Off
allow_webdav_methods = Off
<% end %>

;;;;;;;;;;;;
; Timeouts ;
;;;;;;;;;;;;

max_execution_time = 30
max_input_time = 30
max_input_vars = 10000
default_socket_timeout = 30
mysql.connect_timeout = 30

memory_limit = 128M
post_max_size = 256M
upload_max_filesize = 256M

;;;;;;;;;;
; Compat ;
;;;;;;;;;;

<% if @paranoid %>
short_open_tag = Off
register_globals = Off
allow_call_time_pass_reference = Off
register_long_arrays = Off
register_argc_argv = Off
auto_globals_jit = On
magic_quotes_gpc = Off
magic_quotes_runtime = Off
magic_quotes_sybase = Off
<% end %>

default_mimetype = "text/html" 
;default_charset = "iso-8859-1" 

;;;;;;;;;;;;;;;;
; File Uploads ;
;;;;;;;;;;;;;;;;

file_uploads = On
upload_tmp_dir = <%= @dir_www %>/tmp/php_uploads
max_file_uploads = 5

;;;;;;;;;;;;;;;;;
; Optimizations ;
;;;;;;;;;;;;;;;;;

realpath_cache_size = 256k
realpath_cache_ttl = 7200

;;;;;;;;;;;;;;;;;;;;
; Language Options ;
;;;;;;;;;;;;;;;;;;;;

engine = On
asp_tags = Off              
precision = 14              
y2k_compliance = On         
zlib.output_compression = Off
implicit_flush = Off        
unserialize_callback_func = 
serialize_precision = 100   
zend.enable_gc = On
expose_php = Off
auto_prepend_file =
auto_append_file =
doc_root =
user_dir =
output_buffering = 4096
cgi.fix_pathinfo = 0

; ultra secure (breaks all)
;; variables_order = "GPCS" 

; secure (breaks many)
;; variables_order = "GPSE" 
;; request_order = "GP" 

error_reporting = E_ALL & ~E_DEPRECATED & ~E_NOTICE & ~E_STRICT
display_errors = Off
display_startup_errors = Off
log_errors = On
log_errors_max_len = 1024
ignore_repeated_errors = Off
ignore_repeated_source = Off
report_memleaks = On
track_errors = Off
html_errors = Off

;;;;;;;;;;;;;;;;;;;
; Module Settings ;
;;;;;;;;;;;;;;;;;;;

[Date]
date.timezone = Europe/Moscow

[Syslog]
define_syslog_variables  = Off

[mail function]
SMTP = localhost
smtp_port = 25
;sendmail_from = me@example.com
sendmail_path = /usr/sbin/sendmail -t -i
mail.add_x_header = On

[SQL]
sql.safe_mode = Off

[MySQL]
mysql.allow_persistent = On
mysql.max_persistent = -1
mysql.max_links = -1
mysql.default_port =
mysql.default_socket = /var/lib/mysql/mysql.sock
mysql.default_host =
mysql.default_user =
mysql.default_password =
mysql.trace_mode = Off
mysql.allow_local_infile = Off

[MySQLi]
mysqli.max_links = -1
mysqli.default_port = 3306
mysqli.default_socket = /var/lib/mysql/mysql.sock
mysqli.default_host =
mysqli.default_user =
mysqli.default_pw =
mysqli.reconnect = Off
mysqli.allow_local_infile = Off

[Pdo_mysql]
pdo_mysql.cache_size = 2000
pdo_mysql.default_socket=/var/lib/mysql/mysql.sock

[bcmath]
bcmath.scale = 0

[Session]

session.save_handler = files
session.save_path = "<%= @dir_www %>/tmp/php_sessions" 

<% if @paranoid %>
session.use_cookies = 1
session.use_only_cookies = 1
session.cookie_httponly = 1
;; session.name = PSESS
session.auto_start = 0
session.cookie_lifetime = 0
;; session.cookie_secure = 1
session.cookie_path = /
session.cookie_domain =
session.serialize_handler = php
session.gc_probability = 1
session.gc_divisor = 1000
session.gc_maxlifetime = 1440
session.bug_compat_42 = Off
session.bug_compat_warn = Off
session.referer_check =
session.entropy_length = 0
session.entropy_file =
session.cache_limiter = nocache
session.cache_expire = 30
session.use_trans_sid = 0
session.hash_function = 1
session.hash_bits_per_character = 6
url_rewriter.tags = "a=href,area=href,frame=src,input=src,form=fakeentry" 
<% end %>
